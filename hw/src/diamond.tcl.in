cd hw

if [file exists "@PROJECT_NAME@.ldf"] {
    prj_project open "@PROJECT_NAME@.ldf"
} else {
    prj_project new -name @PROJECT_NAME@ -dev @DEVICE@ -lpf "@LPF_PATH@" -impl "impl" -synthesis "synplify"
    prj_src add "@SDC_PATH@"
    prj_strgy new -name Debug -file debug.sty
    prj_strgy new -name Release -file release.sty
}

prj_src remove -all
@SRL_LIST@

prj_strgy set @STRATEGY@
prj_strgy set_value -strategy Debug \
    par_place_iterator=4 \
    par_stop_zero=True

prj_strgy set_value -strategy Release \
    syn_res_sharing=False \
    map_timing_driven=True \
    map_timing_driven_pack=True \
    par_pathbased_place=On \
    par_routing_res_opt=6 \
    par_route_delay_reduction_pass=10 \
    par_place_iterator=16 \
    par_routeing_pass=100

prj_impl option top @TOP_MODULE@
if {"@STRATEGY@"=="Debug"} {
    prj_impl option VERILOG_DIRECTIVES DEBUG
} else {
    prj_impl option -rem VERILOG_DIRECTIVES
}
prj_project save
prj_run Export -impl impl -task Bitgen
prj_project close

file copy -force impl/@PROJECT_NAME@_impl.bit @PROJECT_NAME@.bit
